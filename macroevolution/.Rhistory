library(caper)
library(geiger)
library(stringr)
library(phytools)
library(ggplot2)
library(dplyr)
install.packages("dplyr")
setwd("/Users/ryanfolk/Documents/GitHub/Botany2024/macroevolution")
# read tree (newick) file
tree = read.tree("workshop.tree.tre")
trees
# read tree (newick) file
tree = read.tree("workshop.tree.tre")
tree
if(is.ultrametric(tree)) {
print("TRUE")
} else {
tree <- force.ultrametric(tree, method="extend")
}
# read tree (newick) file
tree = read.tree("workshop.tree.tre")
plot(tree)
if(is.ultrametric(tree)) {
print("TRUE")
} else {
tree <- force.ultrametric(tree, method="extend")
}
if(is.ultrametric(tree)) {
print("TRUE")
} else {
tree <- force.ultrametric(tree, method="extend")
}
plot(tree)
head(tree$tip.label)
DR_statistic <- function(tree, return.mean = FALSE){
rootnode <- length(tree$tip.label) + 1
sprates <- numeric(length(tree$tip.label))
for (i in 1:length(sprates)){
print(i)
node <- i
index <- 1
qx <- 0
while (node != rootnode){
el <- tree$edge.length[tree$edge[,2] == node]
node <- tree$edge[,1][tree$edge[,2] == node]
qx <- qx + el* (1 / 2^(index-1))
index <- index + 1
}
sprates[i] <- 1/qx
}
if (return.mean) {
return(mean(sprates))
} else {
names(sprates) <- tree$tip.label
return(sprates)
}
}
DR <- DR_statistic(tree)
DR
contMap(tree,DR,plot=FALSE)
BIO1 <- read.csv("BIOCLIM_1.average.csv", header = FALSE,
stringsAsFactors = FALSE, row.names = NULL, sep = ",")
BIO1
elevation <- read.csv("GTOPO30_ELEVATION.average.csv", header = FALSE, stringsAsFactors = FALSE, row.names = NULL, sep = ",")
#give the columns names
colnames(elevation) <- c("species", "elevation")
#keep only distinct values?
elevation <- distinct(elevation, species, .keep_all= TRUE)
colnames(DR) <- c("species", "DR")
DR
nodulation <- read.csv("mimosoid.nod.status.csv")
